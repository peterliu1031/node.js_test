const express = require('express');
const sqlite3 = require('sqlite3').verbose();//開小本本
const cors = require('cors');

const app = express();
const port = process.env.PORT || 3000;

app.use(express.json());
app.use(cors());

const db = new sqlite3.Databse('data.db');
db.run(`CREATE TABLE IF NOT EXISTS sensor_data (
    temperature REAL,
    humidity REAL,
    timestamp TEXT
)`);

app.get('/data', (req, res) =>{
  const limit = parselnt(req.query.limit) || 10;
  db.all('SELECT * FROM sensor_data ORDER BY timestamp DESC LIMIT ?',
  [limit],
  (err, rows) => {
    if(err)return
  );
});
app.post('/data', (req, res)=> {
  const {temp, hum} = req.query;
  
  db.run(
  `INSERT INTO sersor_data`,
  [t, h, timestamp],
  err => {}
  )
});
